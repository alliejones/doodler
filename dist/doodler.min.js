function Node(t){return{data:t,next:null}}function LinkedList(){this.head=null,this.tail=null,this.size=0}function Canvas(t){this.el=document.getElementById(t.id),this.ctx=this.el.getContext("2d"),this.prevMouseCoords={x:null,y:null},this.mouseCoords={x:null,y:null},this.curMouseCoords={x:null,y:null},this.recordingLoop=null,this.recording=new LinkedList,this.recordingInterval=10,this.el.width=t.width,this.el.height=t.height,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.strokeStyle="black",$(this.el).parent(".canvas-container").on("mousedown",this._onMousedown.bind(this)),$(window).on("selectstart",function(){return!1}),$(window).on("mousemove",this._onMousemove.bind(this)),$(window).on("mouseup",this._onMouseup.bind(this))}LinkedList.prototype.prepend=function(t){var o=new Node(t);o.next=this.head,this.head=o,this.size+=1},LinkedList.prototype.append=function(t){var o=new Node(t);this.head?this.tail.next=o:(this.head=o,this.tail=o),this.tail=o,this.size+=1},LinkedList.prototype.print=function(){for(var t=this.head,o=[];t;)o.push(t.data),t=t.next;return o.join(", ")},LinkedList.prototype.toJSON=function(){for(var t=this.head,o=[];t;)o.push(t.data),t=t.next;return o},Canvas.prototype._mapCoords=function(t,o){var i=this.el.getBoundingClientRect();return{x:t-i.left*(this.el.width/i.width),y:o-i.top*(this.el.height/i.height)}},Canvas.prototype._onMousedown=function(t){this._startDrawing(t)},Canvas.prototype._onMouseup=function(){this._stopDrawing()},Canvas.prototype._onMousemove=function(t){this.curMouseCoords=this._mapCoords(t.pageX-$(window).scrollLeft(),t.pageY-$(window).scrollTop())},Canvas.prototype.replay=function(){this._clear(),this._redraw(this.recording.head)},Canvas.prototype._redraw=function(t){this.setStrokeColor(t.data[2][0]),this.setStrokeWidth(t.data[2][1]),this["_"+t.data[0]].apply(this,t.data[1]),t.next?window.setTimeout(function(){this._redraw(t.next)}.bind(this),this.recordingInterval):this.ctx.beginPath()},Canvas.prototype._startDrawing=function(t){var o=this._mapCoords(t.pageX,t.pageY);this.recordingLoop=window.setInterval(this._draw.bind(this),this.recordingInterval),this.ctx.moveTo(o.x,o.y),this.ctx.beginPath()},Canvas.prototype._stopDrawing=function(){this.ctx.beginPath(),this.prevMouseCoords={x:null,y:null},this.mouseCoords={x:null,y:null},window.clearInterval(this.recordingLoop),this.recordingLoop=null},Canvas.prototype.setStrokeColor=function(t){this.ctx.strokeStyle=t},Canvas.prototype.setStrokeWidth=function(t){this.ctx.lineWidth=t},Canvas.prototype._draw=function(){var t=this.prevMouseCoords.x=this.mouseCoords.x,o=this.prevMouseCoords.y=this.mouseCoords.y,i=this.mouseCoords.x=this.curMouseCoords.x,e=this.mouseCoords.y=this.curMouseCoords.y;(null===t||null===o)&&(t=i,o=e),this.line(t,o,i,e)},Canvas.prototype.line=function(t,o,i,e){this.recording.append(["line",[Math.floor(t),Math.floor(o),Math.floor(i),Math.floor(e)],[this.ctx.strokeStyle,this.ctx.lineWidth]]),this._line(t,o,i,e)},Canvas.prototype._line=function(t,o,i,e){this.ctx.beginPath(),this.ctx.moveTo(t,o),this.ctx.lineTo(i,e),this.ctx.stroke()},Canvas.prototype.clear=function(){this.recording=new LinkedList,this._clear()},Canvas.prototype._clear=function(){this.ctx.clearRect(0,0,this.el.width,this.el.height)};